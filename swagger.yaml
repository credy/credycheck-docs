openapi: 3.0.0
info:
  title: CredyCheck API Documentation
  description: |
    # Glossary 

     * Requester - a partner who sends any kind of data query to us 
     * Responder - a partner from whom we query any kind of data 
     * Envelope - encrypted container for personal ID 
     * Us - CredyCheck API 
     
    # Authorization
    
    CredyCheck uses OAuth 2.0 for authorization. 
    
    Grant type: Client Credentials
  version: 3.0.0
paths:
  /v1/start-session:
    post:
      tags:
        - requester => us
      description: |-
        # Start session 
        This method is used to get public keys from other partners in order to encrypt an envelope for each of them. It returns the public keys to the callback provided.
      requestBody:
        content:
          application/json:
            schema:
              properties:
                callback_uri:
                  type: string
                  example: 'http://example.com/my_internal_id_maybe/get_keys'
      responses:
        '202':
          description: Session started
          content:
            application/json:
              schema:
                type: object
                properties:
                  session_uuid:
                    type: string
                    example: b3345507-8298-4bd1-843a-6a968e593f00
  /v1/get-session-key:
    post:
      tags:
        - us => responder
      description: ''
      requestBody:
        content:
          application/json:
            schema:
              properties:
                session_uuid:
                  type: string
                  example: b3345507-8298-4bd1-843a-6a968e593f00
                callback_uri:
                  type: string
                  example: 'http://api.credycheck.com/v1/recieve_key/<responder session UUID-4>'
      responses:
        '202':
          description: ''
  '/v1/set-session-key/{session_uuid}':
    post:
      tags:
        - responder => us
      description: ''
      parameters:
        - name: session_uuid
          in: path
          description: ''
          required: true
          schema:
            format: string
            example: b3345507-8298-4bd1-843a-6a968e593f00
      requestBody:
        content:
          application/json:
            schema:
              properties:
                session_public_key:
                  type: string
                  example: key_binary_data_goes_here
                callback_uri:
                  type: string
                  example: 'http://example.com/my_internal_id_maybe/request_data'
      responses:
        '202':
          description: ''
  '/http://example.com/my_internal_id_maybe/get_keys':
    post:
      tags:
        - us => requester
      description: ''
      requestBody:
        content:
          application/json:
            schema:
              properties:
                session_uuid:
                  type: string
                  example: b3345507-8298-4bd1-843a-6a968e593f00
                keys:
                  type: array
                  items: 
                    type: object
                    properties:
                      key_uuid:
                        type: string
                        example: b3345507-8298-4bd1-843a-6a968e593f00
                      public_key:
                        type: string
                        example: "key_binary_data_goes_here"
      responses:
        '202':
          description: ''
  '/http://api.credycheck.com/v1/<requester session UUID-4>/get_customer_history':
    post:
      tags:
        - requester => us
      description: ''
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                properties:
                  key_uuid:
                    type: string
                    example: b3345507-8298-4bd1-843a-6a968e593f00
                  envelope:
                    type: string
                    example: "encoded personal ID"
      responses:
        '202':
          description: ''
  '/http://example.com/my_internal_id_maybe/request_data':
    post:
      tags:
        - us => responder
      description: ''
      requestBody:
        content:
          application/json:
            schema:
              properties:
                envelope:
                  type: string
                  example: "encoded personal ID"
                session_uuid: 
                  type: string
                  example: b3345507-8298-4bd1-843a-6a968e593f00
                  description: "Responder session UUID-4"
                callback_url: 
                  type: string
                  example: "http://api.credycheck.com/v1/recieve_response/<amazing session UUID-4>"
      responses:
        '202':
          description: ''        
  '/http://api.credycheck.com/v1/recieve_response/<Responder session UUID-4>':
    delete:
      tags: 
        - responder => us
      description: When there's no data for the customer
      responses:
        '200':
          description: ''
    post:
      tags:
        - responder => us
      description: |
        When there's no data for a specific field, null or 0 should be specified as a value (based on field).
        
        When gdpr_consent is false, don't include any data.
      requestBody:
        content:
          application/json:
            schema:
              properties:
                gdpr_consent:
                  type: boolean
                  example: true
                applications_count_30days: 
                  type: integer
                  format: int32
                  example: 2
                applications_count_5days: 
                  type: integer
                  format: int32
                  example: 1
                last_submitted_application_date: 
                  type: string
                  example: "2020-02-01"
                count_of_active_loans: 
                  type: integer
                  format: int32
                  example: 1
                count_of_loans_overdue_5_plus: 
                  type: integer
                  format: int32
                  example: 0
      responses:
        '202':
          description: ''           
  '/http://example.com/my_internal_id_maybe/response_data':
    post:
      tags:
        - us => requester
      description: |
        Aggregated loan history to Requester
      requestBody:
        content:
          application/json:
            schema:
              properties:
                session_uuid:
                  type: string
                  example: "b3345507-8298-4bd1-843a-6a968e593f00"
                total_applications_count_30days: 
                  type: integer
                  format: int32
                  example: 22
                total_applications_count_5days: 
                  type: integer
                  format: int32
                  example: 44
                total_last_submitted_application_date: 
                  type: string
                  example: "2082-07-30"
                total_count_of_active_loans: 
                  type: integer
                  format: int32
                  example: 4
                total_count_of_loans_overdue_5_plus: 
                  type: integer
                  format: int32
                  example: 7
                max_lender_applications_count_30days: 
                  type: integer
                  format: int32
                  example: 5
                max_lender_applications_count_5days: 
                  type: integer
                  format: int32
                  example: 3
                max_lender_count_of_active_loans: 
                  type: integer
                  format: int32
                  example: 2
                max_lender_count_of_loans_overdue_5_plus: 
                  type: integer
                  format: int32
                  example: 3
      responses:
        '204':
          description: ''      